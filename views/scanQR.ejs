<script src="/js/html5-qrcode.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-1.12.4.min.js"
    integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/a2fc7a8880.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.5.6/css/ionicons.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
    integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
    crossorigin="anonymous"></script>
<style>
    .result {
        background-color: green;
        color: #fff;
        padding: 20px;
    }

    .row {
        display: flex;
    }
</style>
<div class="row container">
    <div class="col">
        <div style="width:500px;" id="reader"></div>
    </div>
    <div class="col warning" style="padding:30px;">
        <h4>SCAN RESULT</h4>
        <div class="container" id="result">Result Here</div>
    </div>

</div>
<script type="text/javascript">
    function onScanSuccess(qrCodeMessage) {
        $.ajax({
            url: "/payment/scan-bill",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({ qrcode: qrCodeMessage }),
            success: function (result) {
                if (typeof result == 'object') {
                    $('.container').html(`<form>
        <div class="mb-3">
          <label for="exampleInputPassword1" class="form-label">Idbill</label>
          <input type="text" class="form-control Idbill" value=${result._id} id="exampleInputPassword1">
        </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label ">Trạng thái</label>
            <input type="text" class="form-control checkin" value=${result.checkin} id="exampleInputPassword1">
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label ">Tổng tiền</label>
            <input type="text" class="form-control totalprice" value=${result.total} id="exampleInputPassword1">
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label ">Email</label>
            <input type="text" class="form-control email" value=${result.user} id="exampleInputPassword1">
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label ">Tên</label>
            <input type="text" class="form-control fullname" value=${result.fullname} id="exampleInputPassword1">
          </div>
          <div class="mb-3">
            <label for="exampleInputPassword1" class="form-label ">Số điện thoại</label>
            <input type="text" class="form-control phone" value=${result.phone} id="exampleInputPassword1">
          </div>
        <button type="button" class="btn btn-primary">Xác nhận sử dụng</button>
        <button type="button" class="btn btn-primary">In</button>
      </form>`)
                } else {
                    $('.warning').html(result);
                }
            }
        })
    }
    function onScanError(errorMessage) {
        //handle scan error
    }
    var html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess, onScanError);
</script>